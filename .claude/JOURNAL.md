# Journal

1. **Task - JupyterLab DOCX Reader Extension**: Implement JupyterLab extension to open and view DOCX files in the browser<br>
   **Result**: Created full-featured extension that converts DOCX files to PDF on-the-fly. Used python-docx and reportlab for pure Python conversion (no system dependencies). Implemented server-side API handler for document conversion with base64 encoding for transmission. Frontend displays PDF using embed tag for better browser compatibility. Supports paragraphs, headings, and tables with proper formatting. Includes comprehensive error handling with detailed tracebacks. Added debug and info level logging on server side for monitoring.

2. **Task - Polish Character Support**: Fix rendering of Polish characters (ą, ć, ę, ł, ń, ó, ś, ź, ż) in generated PDFs<br>
   **Result**: Implemented robust Unicode font detection that searches common Linux system paths for TrueType fonts. Extension now tries DejaVu, Liberation, and FreeSans fonts from system locations. Registers found fonts as 'UnicodeSans' and 'UnicodeSansBold' with proper logging. Falls back to Helvetica if no Unicode fonts available. Polish characters now render correctly instead of displaying as box symbols.

3. **Task - CI/CD and Publishing**: Fix GitHub Actions workflow and publish extension to npm and PyPI<br>
   **Result**: Fixed vega-dataflow dependency resolution issue by adding resolutions field to package.json. Fixed CI build workflow by adding build step before tests. Updated README with GitHub Actions, npm, and PyPI badges following GITHUB.md guidelines. Corrected documentation to reflect actual dependencies (python-docx and reportlab instead of mammoth and weasyprint). Added Unicode support feature to README. Configured npm authentication and successfully published to npm registry. Updated Makefile to include npm publish in publish target for synchronized releases. Extension now fully discoverable in JupyterLab Extension Manager. Bumped version to 1.0.0 marking stable production release. Fixed link checker to ignore npm package URL due to rate limiting. Added PyPI downloads badge to README for usage tracking visibility. Published version 1.0.4 to both npm and PyPI registries.

4. **Task - PowerPoint PPTX Support** (v1.1.6): Add support for viewing PowerPoint presentations in JupyterLab<br>
   **Result**: Implemented PPTX to PDF conversion using python-pptx and Pillow libraries following the pure Python approach consistent with DOCX support. Added `_convert_pptx_to_pdf` method in `handlers.py` that uses reportlab canvas for precise slide positioning. Renders text frames with font size, bold, and color detection. Handles images via PIL with automatic format conversion and placeholder fallback. Supports tables with cell borders and text rendering. Maintains original slide aspect ratio (converts EMU to points). Registers PPTX and PPT file types in frontend `index.ts` with proper MIME types. Updated dependencies in `pyproject.toml` adding python-pptx>=0.6.21 and Pillow>=9.0.0. Refactored handlers to separate `_convert_docx_to_pdf` method and added shared `_register_unicode_fonts` utility. Updated README and package.json descriptions. Fixed outdated error messages in widget.ts referencing mammoth/weasyprint. Legacy PPT format shows conversion message (same pattern as DOC/RTF). Created CHECKPOINT_BEFORE_PPT tag before implementation. Fixed import issue in v1.1.5 where reportlab imports were nested inside DOCX try block causing `pdfmetrics not defined` error - separated reportlab imports into their own try block with REPORTLAB_AVAILABLE flag. Fixed v1.1.6 removing non-existent `Emu` import from reportlab.lib.units that caused `cannot import name 'Emu'` error. Committed and pushed to GitHub.
